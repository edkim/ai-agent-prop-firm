# =============================================================================
# AI Backtest Platform - Production Environment Variables
# =============================================================================
#
# Instructions:
#   1. Copy this file to .env on your production server
#   2. Replace all placeholder values with actual values
#   3. Keep this file secure - never commit it to git
#   4. Restart the application after changing any values
#
# Security:
#   chmod 600 .env  # Restrict permissions to owner only
#   chown appuser:appuser .env
#
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

NODE_ENV=production
PORT=3000

# Server URL (used for callbacks, webhooks, etc.)
# Example: https://api.your-domain.com
SERVER_URL=https://your-domain.com

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

# Path to SQLite database file
# Use absolute path in production
DATABASE_PATH=/var/www/ai-backtest/backend/backtesting.db

# Database backup settings
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 3 * * *"  # Daily at 3am
BACKUP_RETENTION_DAYS=30

# -----------------------------------------------------------------------------
# API Keys
# -----------------------------------------------------------------------------

# Anthropic Claude API Key (required for AI agent learning)
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-your-key-here

# Polygon.io API Key (required for market data)
# Get from: https://polygon.io/
POLYGON_API_KEY=your-polygon-api-key-here

# -----------------------------------------------------------------------------
# Paper Trading Configuration
# -----------------------------------------------------------------------------

# Enable paper trading system
PAPER_TRADING_ENABLED=true

# Initial paper trading account balance (in USD)
PAPER_TRADING_INITIAL_BALANCE=100000

# Paper trading mode (paper or live)
# WARNING: Set to 'live' only after thorough testing!
TRADING_MODE=paper

# -----------------------------------------------------------------------------
# Real-Time Data Configuration
# -----------------------------------------------------------------------------

# Enable real-time market data streaming
REALTIME_DATA_ENABLED=true

# Polygon WebSocket reconnection settings
POLYGON_WS_RECONNECT_DELAY=5000
POLYGON_WS_MAX_RECONNECT_ATTEMPTS=10

# Bar aggregation settings
BAR_AGGREGATION_INTERVAL=5min

# -----------------------------------------------------------------------------
# Security & Authentication
# -----------------------------------------------------------------------------

# JWT Secret (generate with: openssl rand -base64 32)
JWT_SECRET=your-random-jwt-secret-here-change-this

# JWT Expiration (in seconds)
JWT_EXPIRATION=86400  # 24 hours

# Session secret
SESSION_SECRET=your-random-session-secret-here-change-this

# CORS allowed origins (comma-separated)
# Example: https://app.your-domain.com,https://staging.your-domain.com
CORS_ORIGINS=https://your-domain.com

# API rate limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------

# Log level (error, warn, info, debug, trace)
LOG_LEVEL=info

# Log file paths
LOG_FILE_PATH=/var/log/ai-backtest/app.log
ERROR_LOG_PATH=/var/log/ai-backtest/error.log

# Log rotation
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10

# Enable console logging
LOG_TO_CONSOLE=false

# -----------------------------------------------------------------------------
# Email Notifications (Optional)
# -----------------------------------------------------------------------------

# SMTP configuration for email alerts
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password

# Email recipients for alerts
ALERT_EMAIL_TO=your-email@example.com
ALERT_EMAIL_FROM=noreply@your-domain.com

# -----------------------------------------------------------------------------
# Cloud Storage (DigitalOcean Spaces / AWS S3)
# -----------------------------------------------------------------------------

# Enable cloud backups
CLOUD_BACKUP_ENABLED=true

# DigitalOcean Spaces configuration
# Get from: https://cloud.digitalocean.com/spaces
SPACES_ENDPOINT=nyc3.digitaloceanspaces.com
SPACES_KEY=your-spaces-access-key-here
SPACES_SECRET=your-spaces-secret-key-here
SPACES_BUCKET=your-backup-bucket-name
SPACES_REGION=nyc3

# Alternative: AWS S3 configuration
# S3_ENDPOINT=s3.amazonaws.com
# S3_KEY=your-aws-access-key-id
# S3_SECRET=your-aws-secret-access-key
# S3_BUCKET=your-s3-bucket-name
# S3_REGION=us-east-1

# -----------------------------------------------------------------------------
# Monitoring & Alerting
# -----------------------------------------------------------------------------

# Enable application monitoring
MONITORING_ENABLED=true

# PM2 monitoring
PM2_PUBLIC_KEY=your-pm2-public-key
PM2_SECRET_KEY=your-pm2-secret-key

# Sentry error tracking (optional)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production

# New Relic APM (optional)
NEW_RELIC_ENABLED=false
NEW_RELIC_LICENSE_KEY=your-new-relic-license-key
NEW_RELIC_APP_NAME=ai-backtest-backend

# -----------------------------------------------------------------------------
# Learning Agent Configuration
# -----------------------------------------------------------------------------

# Max concurrent learning iterations
MAX_CONCURRENT_ITERATIONS=3

# Learning iteration timeout (ms)
ITERATION_TIMEOUT=600000  # 10 minutes

# Auto-learning schedule
AUTO_LEARN_ENABLED=true
AUTO_LEARN_SCHEDULE="0 2 * * *"  # Daily at 2am

# Claude API rate limits
CLAUDE_MAX_REQUESTS_PER_MINUTE=50
CLAUDE_REQUEST_TIMEOUT=120000  # 2 minutes

# -----------------------------------------------------------------------------
# Graduation Settings
# -----------------------------------------------------------------------------

# Minimum iterations before graduation
MIN_ITERATIONS_FOR_GRADUATION=20

# Minimum win rate for graduation (0-1)
MIN_WIN_RATE_FOR_GRADUATION=0.60

# Minimum Sharpe ratio for graduation
MIN_SHARPE_FOR_GRADUATION=2.0

# -----------------------------------------------------------------------------
# Performance & Optimization
# -----------------------------------------------------------------------------

# Node.js memory limit (MB)
NODE_OPTIONS=--max-old-space-size=2048

# Request timeout (ms)
REQUEST_TIMEOUT=60000

# Database connection pool size
DB_POOL_SIZE=10

# Cache TTL (seconds)
CACHE_TTL=3600  # 1 hour

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------

# Enable specific features
ENABLE_CONTINUOUS_LEARNING=true
ENABLE_PAPER_TRADING=true
ENABLE_MANUAL_GUIDANCE=true
ENABLE_AUTO_REFINEMENT=true
ENABLE_REAL_TIME_SCANNING=true

# -----------------------------------------------------------------------------
# Maintenance Mode
# -----------------------------------------------------------------------------

# Enable maintenance mode (blocks all requests except health checks)
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="System under maintenance. Will be back soon."

# -----------------------------------------------------------------------------
# Development/Debug (DO NOT ENABLE IN PRODUCTION)
# -----------------------------------------------------------------------------

# Debug mode (NEVER enable in production!)
DEBUG=false

# Verbose logging
VERBOSE=false

# Enable SQL query logging
LOG_SQL_QUERIES=false
